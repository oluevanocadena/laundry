<modal [(show)]="show" [closeLabel]="'Cancelar'" [confirmLabel]="'Agregar producto a pedido'" [confirmStyle]="'success'"
    (onConfirm)="confirm()" (onClose)="close()" [busy]="busy" [disableConfirm]="canSave === false">
    <span title>
        Búsqueda de producto
    </span>

    <grid body [direction]="'row'" [gap]="[8,8]" padding="1rem 1.5rem">
        <grid [direction]="'row'" width="100%">
            <span class="f-14 fw-400 f-05 f-lh-15">
                ¿Qué producto vas a agregar al pedido?
            </span>
        </grid>

        <!-- Dry Cleaning -->
        <grid [direction]="'row'" [gap]="[16,16]" width="100%">
            <form [formGroup]="formGroup" width="100%">
                <grid [direction]="'row'" [gap]="[24,16]" width="100%" [padding]="'1rem 0 1rem 0'">
                    <form-input [type]="'search'" [placeholder]="'Comienza a escribir para buscar'"
                        formControlName="search" (onSearch)="facade.fetchProducts($event)" />

                    <ng-container *ngIf="products.length === 0">
                        <grid [direction]="'row'" [gap]="[16,16]" width="100%" padding="0 0 0.5rem 0">
                            <span class="f-13 fw-400 f-06 f-lh-16">
                                {{search.value ?
                                'No hay clientes registrados.' :
                                'Comience a escribir para buscar un cliente.'
                                }}
                            </span>
                        </grid>
                    </ng-container>
                    <grid *ngIf="products.length > 0" [direction]="'row'" [gap]="[0,0]" width="100%"
                        [maxHeight]="'450px'" class="scroll-v">
                        <ng-container *ngFor="let product of products">
                            <button full medium flat flex [attr.selected]="isSelected(product)"
                                (click)="selectProduct(product)" class="brdr-bottom">
                                <grid [gap]="[0,16]" [direction]="'column'" [template]="'max-content 1fr max-content'"
                                    width="100%">
                                    <grid [padding]="'0.25rem 0 0.5rem 0'">
                                        <img src="{{product.ImageUrl}}" alt="{{product.Name}}" width="48" height="48"
                                            (error)="onImageError($event)" class="brdr-radius-4 img-cover" />
                                    </grid>
                                    <grid [direction]="'row'" [gap]="[0,8]" [padding]="'0 0 0.5rem 0'">
                                        <span class="f-14 fw-600 f-01 f-lh-17 t-left">
                                            {{product.Name}}
                                        </span>
                                        <span class="f-13 fw-400 f-06 f-lh-16 t-left">
                                            {{product.Description}}
                                        </span>
                                    </grid>
                                    <grid [direction]="'column'" [align]="'center-right'" height="100%">
                                        <span class="f-13 fw-600 f-03">
                                            {{priceAtStore || 0 | numeralFormat: '$0,0.00'}}
                                        </span>
                                    </grid>
                                </grid>
                            </button>
                        </ng-container>
                    </grid>

                    <grid [direction]="'row'" [gap]="[16,16]" width="100%" padding="0 0 0 0">
                        <form-input [label]="'Cantidad'" [type]="'number'" [placeholder]="'Cantidad'"
                            formControlName="quantity" [min]="1" />
                    </grid>
                </grid>
            </form>
        </grid>
    </grid>
</modal>